webpackJsonp([1],{"4rRG":function(e,t){},"6dbh":function(e,t){},"7Sz2":function(e,t){},"7zck":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),i=n("3EgV"),s=n.n(i),a=(n("7zck"),n("Dd8w")),o=n.n(a),c=n("NYxO"),l={name:"Configuration",data:function(){return{e1:!0,opened:!1,reset:!1}},computed:o()({openSettings:function(){return this.opened||!this.gitlabUrl||!this.gitlabToken}},Object(c.b)(["gitlabUrl","gitlabToken","refreshDelay"])),methods:o()({},Object(c.c)(["setGitlabUrl","setGitlabToken","setRefreshDelay"]))},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{persistent:"",value:e.openSettings,"max-width":"500px"}},[n("v-btn",{attrs:{slot:"activator",icon:""},on:{click:function(t){t.stopPropagation(),e.opened=!0}},slot:"activator"},[n("v-icon",[e._v("settings")])],1),e._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Configuration")]),e._v(" "),n("v-card-text",[n("v-text-field",{attrs:{label:"Gitlab URL",value:e.gitlabUrl},on:{input:e.setGitlabUrl}}),e._v(" "),n("v-text-field",{attrs:{password:"",counter:"",label:"Gitlab TOKEN",value:e.gitlabToken,"append-icon":e.e1?"visibility":"visibility_off","append-icon-cb":function(){return e.e1=!e.e1},type:e.e1?"password":"text"},on:{input:e.setGitlabToken}}),e._v(" "),n("v-container",{attrs:{fluid:"","grid-list-xs":""}},[n("v-layout",{staticClass:"align-baseline align-content-end justify-end",attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs3:""}},[n("v-text-field",{attrs:{type:"number",label:"Refresh Delay",step:5,min:5,max:60,value:e.refreshDelay},on:{input:e.setRefreshDelay}})],1),e._v(" "),n("v-flex",{attrs:{xs9:""}},[n("v-slider",{staticClass:"pa-0",attrs:{"thumb-label":"",step:5,min:5,max:60,value:e.refreshDelay},on:{input:e.setRefreshDelay}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){e.opened=!1}}},[e._v("Close")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:function(t){e.reset=!0}}},[e._v("Reset Dashboard")])],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"290"},model:{value:e.reset,callback:function(t){e.reset=t},expression:"reset"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("Confirmation for reset dashboard?")]),e._v(" "),n("v-card-text",[e._v("\n        This process removes all projects from the dashboard and available projects in search list,\n        please confirm to continue?\n      ")]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"green darken-1",flat:"flat"},on:{click:function(t){e.reset=!1}}},[e._v("Cancel")]),e._v(" "),n("v-btn",{attrs:{color:"error darken-1"},on:{click:function(t){e.$store.dispatch("handleClearSelectedProjects").then(e.reset=!1)}}},[e._v("\n          Confirm\n        ")])],1)],1)],1)],1)},staticRenderFns:[]},p={name:"App",components:{Configuration:n("VU/8")(l,u,!1,null,null,null).exports},computed:o()({},Object(c.b)(["gitlabUrl"]),{now:function(){return new Date(Date.now()).toLocaleString()},viewType:{get:function(){return this.$store.getters.viewType},set:function(e){this.$store.commit("setViewType",e)}}})},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("v-toolbar",{attrs:{color:"purple darken-3",dark:"",app:"","clipped-left":e.$vuetify.breakpoint.lgAndUp,fixed:""}},[n("v-toolbar-title",[e._v("GitLab Dashboard - "+e._s(e.gitlabUrl))]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:"",flat:"",ripple:""},on:{click:function(t){e.viewType=!e.viewType}}},[n("v-icon",[e._v(e._s(e.viewType?"view_list":"dashboard"))])],1),e._v(" "),n("Configuration")],1),e._v(" "),n("v-content",[n("v-container",{attrs:{fluid:""}},[n("router-view")],1)],1),e._v(" "),n("v-footer",{attrs:{app:"",dark:"",color:"purple darken-4"}},[n("v-container",{attrs:{fluid:"","text-xs-center":"","grid-list-xs":""}},[e._v(e._s(e.now))])],1)],1)},staticRenderFns:[]};var h=n("VU/8")(p,v,!1,function(e){n("7Sz2")},null,null).exports,d=n("/ocq"),f={name:"SelectProject",data:function(){return{ux_sheet:!1,ux_startY:null,ux_startHeight:null,ux_height:400,ux_isFetching:!1,ux_isDragging:!1,ux_isSearchEnabled:!1,search:"",msgSelectProject:"Selecione o Projeto"}},computed:o()({},Object(c.b)(["getAvailableProjects"]),{filteredAvailableProjects:function(){var e=this,t=this.getAvailableProjects;return this.search&&(t=this.getAvailableProjects.filter(function(t){return t.path_with_namespace.includes(e.search)})),t},selectedProjects:{get:function(){return this.$store.getters.getSelectedProjects.map(function(e){return e.id})},set:function(e){this.$store.dispatch("selectProjectsById",e)}}}),watch:{ux_sheet:function(e){e&&this.fetchAvailableProjects(e)},search:function(e){this.fetchAvailableProjects(e)}},methods:{fetchAvailableProjects:function(){var e=this;this.search||(this.search=""),this.ux_isFetching=!0,this.$store.dispatch("fetchAvailableProjects",this.search).then(function(){e.ux_isFetching=!1})},uxToggleSearch:function(){this.ux_isSearchEnabled=!this.ux_isSearchEnabled,this.ux_isSearchEnabled||(this.search="")},onMouseDown:function(e){this.ux_isDragging=!0,this.ux_startY=e.pageY,this.ux_startHeight=this.ux_height},onMouseMove:function(e){if(this.ux_isDragging){var t=e.pageY-this.ux_startY;this.ux_height=this.ux_startHeight-t}},onMouseUp:function(){this.ux_isDragging=!1}}},_={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-bottom-sheet",{attrs:{inset:"",lazy:""},model:{value:e.ux_sheet,callback:function(t){e.ux_sheet=t},expression:"ux_sheet"}},[n("v-btn",{attrs:{slot:"activator",fixed:"",bottom:"",right:"",fab:"",dark:"",color:"pink"},slot:"activator"},[n("v-icon",[e._v("add")])],1),e._v(" "),n("v-card",{on:{mousemove:e.onMouseMove,mouseleave:e.onMouseMove,mouseup:e.onMouseUp}},[n("v-toolbar",{attrs:{id:"toolbarPanel",color:"cyan",dark:""}},[n("v-toolbar-side-icon",{on:{mousedown:e.onMouseDown}}),e._v(" "),e.ux_isSearchEnabled?n("v-text-field",{attrs:{autofocus:"","prepend-icon":"search","append-icon":"close","append-icon-cb":e.uxToggleSearch,label:"Search","solo-inverted":"",flat:""},on:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"esc",27,t.key,"Escape")?e.uxToggleSearch(t):null}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}):[n("v-toolbar-title",{on:{click:e.uxToggleSearch}},[e._v(e._s(e.msgSelectProject))]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:e.uxToggleSearch}},[n("v-icon",[e._v("search")])],1)]],2),e._v(" "),n("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.ux_isFetching,expression:"ux_isFetching"}],staticClass:"pt-0, ma-0",attrs:{indeterminate:"",color:"cyan",height:"7"}}),e._v(" "),n("v-list",{staticClass:"scroll-y pt-0",style:{maxHeight:this.ux_height+"px"},attrs:{id:"projectList","two-line":""}},[e._l(e.filteredAvailableProjects,function(t){return[n("v-list-tile",{key:t.name_with_namespace,attrs:{avatar:""}},[n("v-list-tile-action",[n("v-checkbox",{attrs:{readonly:"",value:t.id,id:"ch"+t.id},model:{value:e.selectedProjects,callback:function(t){e.selectedProjects=t},expression:"selectedProjects"}})],1),e._v(" "),n("v-list-tile-avatar",{attrs:{color:"blue"}},[t.avatar_url?n("img",{attrs:{src:t.avatar_url}}):n("v-card-text",[e._v(e._s(t.name.substring(0,1).toUpperCase()))])],1),e._v(" "),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{innerHTML:e._s(t.name)}}),e._v(" "),n("v-list-tile-sub-title",{domProps:{innerHTML:e._s(t.path_with_namespace)}})],1)],1)]})],2)],1)],1)},staticRenderFns:[]},g=n("VU/8")(f,_,!1,null,null,null).exports,b=n("fZjL"),j=n.n(b),m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-avatar",{class:[{animation:this.isRunning},this.getPipelineStatusColor]},[t("v-icon",{attrs:{dark:""}},[this._v(this._s(this.getPipelineStatusIcon))])],1)},staticRenderFns:[]};var P={name:"PipelineStatus",components:{StatusIndicator:n("VU/8")({name:"PipelineStatus",props:{pipeline:{}},computed:{isRunning:function(){return"running"===this.pipeline.status},getPipelineStatusColor:function(){switch(this.pipeline.status){case"success":return"green";case"failed":return"red";case"pending":return"orange";case"running":return"blue";case"manual":return"brown lighten-1";default:return"grey darken-1"}},getPipelineStatusIcon:function(){switch(this.pipeline.status){case"success":return"check";case"failed":return"block";case"pending":return"pause";case"running":return"play_arrow";case"manual":return"skip_next";default:return"remove"}}}},m,!1,function(e){n("6dbh")},"data-v-08405750",null).exports},props:{project:{},pipeline:{},objecttype:{type:String,default:"pipelines"}},methods:{openPipeline:function(){window.open(this.project.web_url+"/"+this.objecttype+"/"+this.pipeline.id,"_blank")}}},y={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-chip",{key:this.pipeline.id,on:{click:this.openPipeline}},[t("StatusIndicator",{attrs:{pipeline:this.pipeline}}),this._v("\n    "+this._s(this.pipeline.ref)+"\n")],1)},staticRenderFns:[]};var x=n("VU/8")(P,y,!1,function(e){n("u27E")},null,null).exports,k={name:"ProjectStatus",components:{PipelineStatus:x},props:{project:{},isLastItem:!0},data:function(){return{interval:0,isFetching:!1}},created:function(){this.fetchProject(),this.interval=setInterval(this.fetchProject,1e3*this.$store.getters.refreshDelay)},beforeDestroy:function(){clearInterval(this.interval)},methods:{removeProject:function(){this.$store.dispatch("handleRemoveProject",this.project)},fetchProject:function(){var e=this;this.isFetching=!0,this.$store.dispatch("handleProjectLoad",this.project).then(function(){e.isFetching=!1})},sortByKey:function(e){var t={};return j()(e).sort().forEach(function(n){t[n]=e[n]}),t}},filters:{capitalize:function(e){return e?(e=e.toString()).charAt(0).toUpperCase()+e.slice(1):""}}},w={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-list-tile",{key:e.project.id},[n("v-list-tile-content",[n("v-list-tile-title",[n("h3",{staticClass:"headline"},[e._v(e._s(e.project.name)+" |")]),e._v(" "),n("span",{staticClass:"subheader pl-2"},[e._v(e._s(e.project.path_with_namespace))])]),e._v(" "),e._l(e.sortByKey(e.project.pipelines),function(t,r){return n("div",{key:r+e.project.id},[n("v-list-tile-sub-title",[n("span",[n("b",[e._v(e._s(e._f("capitalize")(r)))])]),e._v(" "),e._l(t,function(t){return["variables"===r?[e._v("\n              "+e._s(t.key)+" - "+e._s(t.value)+"\n            ")]:n("PipelineStatus",{key:t.id,attrs:{pipeline:t,project:e.project}})]})],2)],1)})],2),e._v(" "),n("v-list-tile-action",[e.isFetching?n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):n("v-btn",{attrs:{icon:"",flat:"",ripple:"",color:"error"},on:{click:e.removeProject}},[n("v-icon",[e._v("delete")])],1)],1)],1),e._v(" "),n("v-divider",{directives:[{name:"show",rawName:"v-show",value:!e.isLastItem,expression:"!isLastItem"}]})],1)},staticRenderFns:[]};var S=n("VU/8")(k,w,!1,function(e){n("4rRG")},null,null).exports,T={name:"ProjectCard",components:{PipelineStatus:x},props:{project:{}},data:function(){return{interval:0,isFetching:!1}},created:function(){this.fetchProject(),this.interval=setInterval(this.fetchProject,1e3*this.$store.getters.refreshDelay)},beforeDestroy:function(){clearInterval(this.interval)},methods:{removeProject:function(){this.$store.dispatch("handleRemoveProject",this.project)},fetchProject:function(){var e=this;this.isFetching=!0,this.$store.dispatch("handleProjectLoad",this.project).then(function(){return e.isFetching=!1})}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",[n("v-card",{staticClass:"white--text flexcard",attrs:{color:"blue-grey darken-3",height:"100%"}},[n("v-progress-linear",{staticClass:"py-0 my-0",attrs:{indeterminate:e.isFetching,color:"purple","background-opacity":"0",height:"6"}}),e._v(" "),n("v-card-title",{staticClass:"pt-2",attrs:{"primary-title":""}},[n("div",[n("h2",{staticClass:"headline d-block"},[e._v(e._s(e.project.name))]),e._v(" "),n("div",[e._v(e._s(e.project.path_with_namespace))])]),e._v(" "),n("v-spacer")],1),e._v(" "),e.project.pipelines?n("v-card-actions",{staticClass:"grow"},[e.project.pipelines.branches?n("div",[n("h3",{staticClass:"subheading"},[e._v("Branches")]),e._v(" "),e._l(e.project.pipelines.branches,function(t){return n("PipelineStatus",{key:t.id,attrs:{pipeline:t,project:e.project}})})],2):e._e()]):e._e(),e._v(" "),e.project.pipelines?n("v-card-actions",{staticClass:"grow"},[e.project.pipelines.tags?n("div",[n("h3",{staticClass:"subheading"},[e._v("Tags")]),e._v(" "),e._l(e.project.pipelines.tags,function(t){return n("PipelineStatus",{key:t.id,attrs:{pipeline:t,project:e.project}})})],2):e._e()]):e._e(),e._v(" "),e.project.pipelines?n("v-card-actions",{staticClass:"grow"},[e.project.pipelines.environments?n("div",[n("h3",{staticClass:"subheading"},[e._v("Environments")]),e._v(" "),e._l(e.project.pipelines.environments,function(t){return n("PipelineStatus",{key:t.id,attrs:{pipeline:t,objecttype:"environments",project:e.project}})})],2):e._e()]):e._e()],1)],1)},staticRenderFns:[]},U={name:"Dashboard",components:{ProjectCard:n("VU/8")(T,C,!1,null,null,null).exports,ProjectStatus:S,SelectProject:g},computed:o()({},Object(c.b)(["gitlab_project_query","getSelectedProjects","viewType"])),methods:{isLastItem:function(e){return this.getSelectedProjects.length===e+1}}},D={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{attrs:{id:"dashboard",fluid:"","grid-list-xs":"","pa-0":"","ma-0":"",dark:""}},[e.viewType?n("v-container",{directives:[{name:"show",rawName:"v-show",value:e.getSelectedProjects.length,expression:"getSelectedProjects.length"}],attrs:{"grid-list-xs":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:"","d-flex":""}},e._l(e.getSelectedProjects,function(e){return n("ProjectCard",{key:e.id,attrs:{project:e}})}))],1):n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-card",[n("v-list",{directives:[{name:"show",rawName:"v-show",value:e.getSelectedProjects.length,expression:"getSelectedProjects.length"}]},e._l(e.getSelectedProjects,function(t,r){return n("ProjectStatus",{key:t.id,attrs:{project:t,"is-last-item":e.isLastItem(r)}})}))],1)],1)],1),e._v(" "),n("SelectProject")],1)},staticRenderFns:[]},R=n("VU/8")(U,D,!1,null,null,null).exports;r.a.use(d.a);var E=new d.a({routes:[{path:"/",name:"Dashboard",component:R}]}),F=n("v/L+"),A=n.n(F),$=(n("sax8"),{state:{_gitlabUrl:"https://gitlab.com",_gitlabToken:"",_viewType:!1,_refreshDelay:10},getters:{gitlabUrl:function(e){return e._gitlabUrl},gitlabToken:function(e){return e._gitlabToken},viewType:function(e){return e._viewType},refreshDelay:function(e){return e._refreshDelay}},mutations:{setGitlabUrl:function(e,t){e._gitlabUrl=t},setGitlabToken:function(e,t){e._gitlabToken=t},setViewType:function(e,t){e._viewType=t},setRefreshDelay:function(e,t){e._refreshDelay=t}}}),I=n("//Fk"),M=n.n(I),L=n("mvHQ"),G=n.n(L),O=n("M4fF"),N=n.n(O),V={gitlab_project_query:function(e){return j()(e._gitlab_query_params).reduce(function(t,n){return t.match("=")||(t=t+"="+e._gitlab_query_params[t]),t+"&"+n+"="+e._gitlab_query_params[n]})},getAvailableProjects:function(e){return e.availableProjects},getSelectedProjects:function(e){return e.selectedProjects}},q={state:{isFetching:!1,selectedProjects:[],availableProjects:[],_gitlab_query_params:{search:"",order_by:"path",sort:"asc",membership:!0,per_page:25}},getters:V,mutations:{setSearch:function(e,t){r.a.set(e._gitlab_query_params,"search",t)},setSelectedProjects:function(e,t){t.forEach(function(n,r){if(n){var i=e.selectedProjects.find(function(e){return e.id===n.id});i?n.pipelines=i.pipelines:n.pipelines||(n.pipelines={})}else t[r]=e.selectedProjects[r]}),e.selectedProjects=t},clearSelectedProjects:function(e){e.selectedProjects=[],e._gitlab_query_params.per_page=25},removeProject:function(e,t){var n=e.selectedProjects.findIndex(function(e){return e.id===t.id});(n||0===n)&&e.selectedProjects.splice(n,1)},setAvailableProjects:function(e,t){e.availableProjects=N.a.sortBy(t,"path_with_namespace")},setProjectPipeline:function(e,t){var n=e.selectedProjects.findIndex(function(e){return e.id===t.project.id});r.a.set(e.selectedProjects[n].pipelines,t.prop,t.json)}},actions:{selectProjectsById:function(e,t){var n=e.state,r=e.commit,i=t.map(function(e){return n.availableProjects.find(function(t){return t.id===e})});r("setSelectedProjects",JSON.parse(G()(i)))},fetchAvailableProjects:function(e,t){var n=e.state,r=e.rootGetters,i=e.commit;if(!t||t.length>=3){i("setSearch",t);var s=r.gitlabUrl+"/api/v4/projects?"+V.gitlab_project_query(n)+"&private_token="+r.gitlabToken;return console.log(s),fetch(s).then(function(e){return e.json()}).then(function(e){e&&e instanceof Array&&e.length&&i("setAvailableProjects",e)})}},handleClearSelectedProjects:function(e){(0,e.commit)("clearSelectedProjects")},handleProjectLoad:function(e,t){var n=e.rootGetters,r=e.commit,i=fetch(n.gitlabUrl+"/api/v4/projects/"+t.id+"/pipelines?scope=branches&per_page=3&private_token="+n.gitlabToken).then(function(e){return e.json()}).then(function(e){e.length&&r("setProjectPipeline",{project:t,json:e,prop:"branches"})}),s=fetch(n.gitlabUrl+"/api/v4/projects/"+t.id+"/pipelines?scope=tags&per_page=3&private_token="+n.gitlabToken).then(function(e){return e.json()}).then(function(e){e.length&&r("setProjectPipeline",{project:t,json:e,prop:"tags"})}),a=fetch(n.gitlabUrl+"/api/v4/projects/"+t.id+"/environments?private_token="+n.gitlabToken).then(function(e){return e.json()}).then(function(e){e.length}),o=fetch(n.gitlabUrl+"/api/v4/projects/"+t.id+"/variables?private_token="+n.gitlabToken).then(function(e){return e.json()}).then(function(e){e.length});return M.a.all([i,s,a,o])},handleRemoveProject:function(e,t){(0,e.commit)("removeProject",t)}}};r.a.use(c.a);var H=new A.a({strictMode:!1,storage:window.localStorage}),z=new c.a.Store({modules:{configuration:$,projects:q},mutations:{RESTORE_MUTATION:H.RESTORE_MUTATION},strict:!1,plugins:[H.plugin]});r.a.use(s.a),r.a.config.productionTip=!1,new r.a({el:"#app",store:z,router:E,components:{App:h},template:"<App/>"})},u27E:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b0adf271e648ae7e172b.js.map